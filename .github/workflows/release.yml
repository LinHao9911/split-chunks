name: Release

on:
  workflow_dispatch:
    inputs:
      dry-run:
        description: 'Run in dry-run mode (no actual publishing)'
        required: false
        default: false
        type: boolean
      npm-tag:
        description: 'NPM tag for publishing'
        required: false
        default: 'latest'
        type: choice
        options:
          - latest
          - alpha
          - beta
          - canary

env:
  DEBUG: napi:*

jobs:
  build:
    name: Build
    uses: rspack-contrib/rspack-toolchain/.github/workflows/build.yml@v1
    with:
      napi-build-command: pnpm build --release

  output:
    name: Upload Artifact
    uses: actions/upload-artifact@v4
    with:
      name: build-output  # 工件名称
      path: crates/binding/         # 要上传的目录或文件